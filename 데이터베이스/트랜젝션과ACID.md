# 트랜젝션
- 트랜젝션이란, 가장 좋은 예시로 계좌이체를 예시로 들 수 있다.
<img src="https://user-images.githubusercontent.com/104331549/172764015-20ac4192-8d55-41c2-a517-6e66f2a20c9d.png">
    - 위에서 A씨가 B씨에게 5만워을 송금해주는 상황을 봐보자
      1. 은행은 A씨 계좌를 찾아 5만원을 출금해야한다. 
      2. 그다음 은행은 B씨 계좌를 찾아 5만원을 입금해줘야한다. 
- 이처럼 여러 개의 작업을 하나로 묶은 실행 유닛을 트랜젝션이라고 한다.
- 하나의 특정 작업으로 시작을 해 묶여 있는 모든 작업들을 다 완료해야 정상적으로 종료하는 것을 말한다.
  - 즉, 작업 하나라도 실패하면 트랜잭션도 실패이고, 모든 작업이 성공해야 트랜잭션 또한 성공인 것이다.
  
> 이런 데이터베이스 트랜젝션은 ACID라는 특성을 가지고 있다. 

# ACID
- 데이터베이스 내에서 일어나는 하나의 트랜젝션의 안정성을 보장하기 위해 필요한 성질을 말한다. 
- 4가지 특성의 앞자리를 따서 ACID라고 한다.
- 보통 금융권에서 트랜젝션을 많이 사용하며, ACID는 필수로 따른다고 한다.
## Atomicity(원자성)
- 트랜잭션에 속해있는 모든 작업(데이터읽기/쓰기, 업데이트, 삭제하기 등)을 하나의 단위로 취급한다.
- 그래서, 모든 작업이 성공하면,전부 성공적으로 완료를 시키고, 무언가 부분적으로 실패하는 부분이 있다면 전부 실패하도록 하는 것
  <img src="https://user-images.githubusercontent.com/104331549/172764631-3bcfd25e-4a19-4430-acc1-92753b7af3ac.png">
  - 위처럼 A씨의 계좌에서는 5만원이 출금이 되었는데, B씨에게 5만원 입금작업이 실패했다면, 5만원은 공중분해되는 것과 다름없다. 
  - 그렇기에, 애초에 처음으로 돌아가야하기에, 5만원을 출금했던 내용도 실패시켜 다시 원래되로 되돌리는 것이다.
  
## Consistency(일관성)
 - 데이터 베이스의 상태가 일관되어야한다는 성질이다.
 - 트랜잭션이 테이블에 변경 사항을 적용할 때 미리 정의된, 예측할 수 있는 방식만 취급한다.
 - 즉, 데이터베이스를 조회할 때, 필수로 필요한 내용들을 정해놓은 규약이 있으면, 트랜젝션은 그 규약을 위반하는 행위를 하면 안된다. 
    - 예를들어, 계좌이체시 본인인증을 위해 필요한 정보(이름, 핸드폰번호,비밀번호)가 있다고 가정하였을 때,
    - 정보를 삭제하거나, 전혀다른 정보로 변경하는 쿼리는 `Consistency`를 위반한다.

## Isolation(격리성, 고립성)
 - 여러 사용자가 같은 테이블에서 모두 동시에 읽고 쓰기 작업을 할 때, 각각의 트랜잭션을 격리하면 동시 트랜잭션이 서로 방해하거나 영향을 미치지 않습니다.
 - 연속으로 실행된 것과 동일한 결과를 나타내야한다. 
   - 트랜젝션 자체가 여러개의 작업을 하나로 묶은 것이라서 먼저 실행하여 완료가 되지 않아도, 그다음 트랜젝션이 시작할 수 있다.
   - 이와같이 동시에 두 트랜젝션이 작업을 해도, 서로 방해하지 않아야하며, 마치 하나씩 발생하는 것 처럼 연속적으로 실행되어야 한다.
## Durability(영속성)
 - 트랜젝션을 수행했다면 해당 트랜잭션에 대한 로그를 남겨야 한다.
 - 실행으로 인해 데이터에 적용된 변경 사항이 저장되도록 보장합니다. (시스템 오류가 발생해도 마찬가지)
 - **해당 기록은 영구적이어야한다** > 그래서 영속성
   - 예를 들어 은행에서 계좌이체를 성공적으로 실행한 뒤에, 해당 은행의 서버가 오류가 발생하더라도, 계좌이체 내역은 기록에 남아있어야 한다. 